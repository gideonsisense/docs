<?xml version="1.0" encoding="utf-8"?>
<html xmlns:MadCap="http://www.madcapsoftware.com/Schemas/MadCap.xsd">
    <head><title>Connecting to Google BigQuery | Sisense | Documentation</title>
    </head>
    <body>
        <h1>Connecting to Google BigQuery</h1>
        <p>The <MadCap:variable name="Variables.ECM" /> provides you with quick and easy access to Google BigQuery tables enabling you to generate and analyze your data.</p>
        <p>There are two connection types you can configure when connecting to your BigQuery tables, DSN and Connection String (DSN-Less). For more information about the differences between the connection types, click <a href="odbc.htm">here</a>.</p>
        <p>To connect to your BigQuery tables, follow these steps:</p>
        <ol>
            <li><a href="#Download">Download the Sisense BigQuery ODBC driver and connect the data source in the ElastiCube Manager</a>
            </li>
            <li><a href="#Adding">Add a DSN</a>
            </li>
            <li><a href="#Advanced">(Optional) Configure advanced DSN configurations</a>
            </li>
            <li><a href="#Logging">(Optional) Configure logging settings</a>
            </li>
            <li><a href="#Adding2">Add the BigQuery tables to your project</a>
            </li>
        </ol>
        <h2 class="notoc"><a name="Download"></a>Downloading and Connecting the <MadCap:variable name="Variables.CompanyName" /> Google BigQuery ODBC Driver</h2>
        <ol>
            <li><a href="http://data.sisense.com/drivers/odbc/BigQuery/x64/released/Sisense Google BigQuery ODBC Driver x64 v2.0.1.21.exe">Download</a> and install the <MadCap:variable name="Variables.CompanyName" /> BigQuery ODBC Driver.</li>
            <li>In <MadCap:variable name="Variables.ECM" />, click <span class="bold">Add Data</span> and then, <span class="bold">Generic ODBC Driver</span>.</li>
            <li>Select <span class="bold">DSN</span>. If a DSN file has already been created, select it in the dropdown list, and click <span class="bold">Test Connection</span>. If your connection has been set up, you can click <span class="bold">OK</span> and review the tables generated by the <MadCap:variable name="Variables.CompanyName" /> BigQuery ODBC driver.<br /><img src="../../../Resources/Images/bigquery2.png" class="thumblarge" /><br />OR<br />Select Connection String (DSN-Less) and enter your Connection String. Click <span class="bold">Test Connection</span>.  For more information, see <a href="#">Connecting without a DSN</a>.</li>
        </ol>
        <h2 class="notoc"><a name="Adding"></a>Adding a DSN</h2>
        <p>If a DSN has not yet been created, you must add the DSN manually.</p>
        <p><span class="bold">Note</span>: To add a DSN you must run the ODBC Data Source Administrator (64-bit) as a Windows administrator.</p>
        <p class="bold">To add a DSN:</p>
        <ol>
            <li>Click <span class="bold">Add DSN</span>.<br /><img src="../../../Resources/Images/createnewdataSource (1).png" class="thumblarge" /></li>
            <li>Select the <span class="bold">System Data Source</span> option. The created file applies to all users in a specific machine only. Click <span class="bold">Next</span>.</li>
            <li>Select the <MadCap:variable name="Variables.CompanyName" /> Google BigQuery ODBC Driver, and click <span class="bold">Next</span>.<br /><img src="../../../Resources/Images/createbig (1).png" class="thumblarge" /></li>
            <li>Click <span class="bold">Finish</span>. The ODBC Driver for Google BigQuery DSN Setup dialog box opens.</li>
            <li>Enter the following information:
               <p>In the Data Source Name field, type a name for your DSN.</p><p>Optionally, in the Description field, type relevant details about the DSN.</p><p>Configure authentication using one of the following methods:</p></li>
            <p><span class="bold">To authenticate the connection as a service:</span>
                <ol>
                    <li>From the <span class="boolean">OAuth Mechanism</span> list, select Service Authentication.</li>
                    <li>In the <span class="bold">Email</span> field, type your service account email ID.</li>
                    <li>In the <span class="bold">Key File Path</span> field, type the path to the .p12 key file that is used to authenticate the service account ID.</li>
                </ol>
            </p><span class="bold">Or, to authenticate the connection as a user:</span>
            <br />
            <ol>
                <li>From the <span class="bold">OAuth Mechanism</span> list, select <span class="bold">User Authentication</span>.</li>
                <li>Click <span class="bold">Sign In</span>.</li>
                <li>In the browser that opens, type your credentials for accessing your BigQuery data, and then click <span class="bold">Sign In</span>.</li>
                <li>When prompted to allow BigQuery Client Tools to access your data in Google BigQuery, click <span class="bold">Accept</span>.</li>
                <li>Copy the code that Google provides, and then paste the code in the <span class="bold">Confirmation Code</span> field in the Simba ODBC Driver for Google BigQuery DSN Setup dialog box.</li>
                <li>When you paste the confirmation code, the <span class="bold">Refresh Token</span> populates automatically when you select the field. The refresh token is used whenever the driver needs to access your BigQuery data. You can save the refresh token in the DSN so that you only need to generate it once.</li>
                <p><span class="bold">Note</span>: A confirmation code can only be used once. You must get a new confirmation code from Google whenever you need another refresh token.</p>
            </ol>
            <li>To allow the driver to access Google Drive so that it can support federated tables that combine BigQuery data with data from Google Drive, select the <span class="bold">Request Google Drive Scope Access</span> check box.</li>
            <li>Choose one:</li>
            <ul>
                <li>To verify the server using the trusted CA certificates from a specific .pem file, specify the full path to the file in the <span class="bold">Trusted Certificates</span> field and leave the <span class="bold">Use System Trust Store</span> check box cleared.</li>
                <li>Or, to use the trusted CA certificates .pem file that is installed with the driver, leave the default value in the <span class="bold">Trusted Certificates </span>field and the <span class="bold">Use System Trust Store</span> check box cleared.</li>
                <li>Or, to use the Windows Trust Store, select the Use System Trust Store check box and leave the <span class="bold">Trusted Certificates</span> field cleared.</li>
            </ul>
            <li>In the <span class="bold">Catalog (Project)</span> list, select the name of your BigQuery project. This project is the default project that the ODBC Driver for Google BigQuery queries against, and also the project that is billed for queries that are run using the DSN.</li>
            <li>(Optional) To configure advanced driver options, click <span class="bold">Advanced Options</span>. For more information, see <a href="#Advanced">Advanced Options</a>.</li>
            <li>(Optional) To configure logging behavior for the driver, click <span class="bold">Logging Options</span>. For more information, see <a href="#Logging">Logging Options</a>.</li>
            <li>Click Test. A pop window is displayed that indicates the connection was successful.</li>
            <li>Click <span class="bold">OK</span>.</li>
            <li>In the ODBC Connectivity Properties window, click <span class="bold">Test Connection</span>.</li>
            <li>Click <span class="bold">OK</span> to save and close the ODBC Data Source Administrator.</li>
        </ol>
        <h3 class="notoc"><a name="Advanced"></a>Advanced Options</h3>
        <p>You can configure advanced driver by clicking <span class="bold">Advanced Options</span> in the <MadCap:variable name="Variables.CompanyName" /> BigQuery ODBC Driver DSN Setup window. This displays the Advanced Options window from which you can configure the following options:</p>
        <p>
            <img src="../../../Resources/Images/bigqueryadvancedoptions (1).png" class="thumblarge" />
        </p>
        <table>
            <thead>
                <tr>
                    <th>Field</th>
                    <th>Description</th>
                </tr>
            </thead>
            <tbody>
                <tr>
                    <td>Max Requests Per Second (0=unlimited)</td>
                    <td>
                        <p>Enter the maximum number of requests that can be made per second.</p>
                        <p><span class="bold">Note</span>: To allow an unlimited number of requests per second with no throttling, type 0.</p>
                    </td>
                </tr>
                <tr>
                    <td>Rows Per Block</td>
                    <td>Enter the maximum number of rows to fetch for each data request.</td>
                </tr>
                <tr>
                    <td>Default String Column Length</td>
                    <td>Enter the maximum data length for String columns.</td>
                </tr>
                <tr>
                    <td>Dataset Name For Large Result Sets</td>
                    <td>
                        <p>Enter the name of the BigQuery dataset to use to store temporary tables.</p>
                        <p><span class="bold">Note</span>: The dataset created from the default ID is hidden.</p>
                    </td>
                </tr>
                <tr>
                    <td>Temporary Table Expiration Time(ms)</td>
                    <td>Enter the length of time (in milliseconds) that the temporary table exists for.</td>
                </tr>
                <tr>
                    <td>Use Native Query</td>
                    <td>
                        <p>Select the Use Native Query checkbox to disable the SQL Connector feature and allow the driver to execute BigQuery SQL directly. When Use Native Query is selected, the driver does not transform the queries emitted by an application, so the native query is used. When Use Native Query is disabled, the driver transforms the queries emitted by an application and converts them into an equivalent form in BigQuery SQL.</p>
                        <p><span class="bold">Note</span>: If an application already emits BigQuery SQL, then enable this option to avoid the extra overhead of query transformation. (Optional)</p>
                    </td>
                </tr>
                <tr>
                    <td>Enable SQLPrepare Metadata with Native Query (slower)</td>
                    <td>
                        <p>To enable the driver to retrieve metadata during the prepare stage of a query when working in Native Query mode, select the Enable SQLPrepare Metadata with Native Query checkbox.</p>
                        <p><span class="bold">Note</span>: This option is available only if the Use Native Query checkbox is selected.</p>
                    </td>
                </tr>
                <tr>
                    <td>Allow Large Result Sets</td>
                    <td>Select to to allow query results larger than 128MB in size.After you select this checkbox, the Dataset Name For Large Result Sets and Temporary Table Expiration Time(ms) fields are enabled.</td>
                </tr>
            </tbody>
        </table>
        <h3 class="notoc"><a name="Logging"></a>Logging Options</h3>
        <p>You can configure logging options by clicking <span class="bold">Logging Options</span> in the <MadCap:variable name="Variables.CompanyName" /> BigQuery ODBC Driver DSN Setup window. This displays the Logging Options window.</p>
        <p>
            <img src="../../../Resources/Images/bigqueryloggingoptions (1).png" />
        </p>
        <p>The ODBC Data Source Administrator provides tracing functionality, which you can activate to help troubleshoot issues.</p>
        <p><span class="bold">Important</span>: Only enable logging long enough to capture an issue. Logging decreases performanceand can consume a large quantity of disk space.</p>
        <p>The driver allows you to set the amount of detail included in log files. The table below  lists the logging levels provided by the <MadCap:variable name="Variables.CompanyName" /> ODBC Driver with SQL Connector for Google BigQuery, in order from least verbose to most verbose.</p>
        <p>In the Logging Options window, you can configure the following information:</p>
        <table>
            <thead>
                <tr>
                    <th>Field</th>
                    <th>Description</th>
                </tr>
            </thead>
            <tbody>
                <tr>
                    <td>Log Level</td>
                    <td>
                        <p>Select the Log Level. There are seven possible options:</p>
                        <p><span class="bold">LOG_OFF</span>: Disables all logging.</p>
                        <p><span class="bold">LOG_FATAL</span>: Logs very severe error events that lead the driver to abort.</p>
                        <p><span class="bold">LOG_ERROR</span>: Logs error events that might still allow the driver to continue running.</p>
                        <p><span class="bold">LOG_WARNING</span>:Logs potentially harmful situations.</p>
                        <p><span class="bold">LOG_INFO</span>: Logs general information that describes the progress of the driver.</p>
                        <p><span class="bold">LOG_DEBUG</span>: Logs detailed information that is useful for debugging the driver.</p>
                        <p><span class="bold">LOG_TRACE</span>: Logs more detailed information than the DEBUG level.</p>
                    </td>
                </tr>
                <tr>
                    <td>Log Path</td>
                    <td>
                        <p>Enter the full path to the folder where you want to save log files.</p>
                        <p>OR</p>
                        <p>Click <span class="bold">Browse</span> and select the folder where you want to save log files.</p>
                    </td>
                </tr>
                <tr>
                    <td>Log Rotation</td>
                    <td>
                        <p>Enter the maximum number of log files to keep in the Max Number Files field.</p>
                        <p><span class="bold">Note</span>: After the maximum number of log files is reached, each time an additional file is created, the driver deletes the oldest log file.</p>
                        <p>Enter the maximum size of each log file in megabytes (MB) in the Max File Size field.</p>
                        <p><span class="bold">Note</span>: After the maximum file size is reached, the driver creates a new file and continues logging.</p>
                    </td>
                </tr>
            </tbody>
        </table>
        <h2 class="notoc">Connecting without a DSN</h2>
        <p>When you choose to connect without a DSN, you must define the connection string that sets the configuration options.</p>
        <p>The following is an example connection string that sets advanced options:</p>
        <p><span class="code">DSN=Sample Sisense BigQuery DSN; Catalog=public_data; MaxRequestsPerSecond=20; UseNativeQuery=0; AllowLargeResults=0; LargeResultsDataSetId=_bqodbc_temp_tables; LargeResultsTempTableExpirationTime=3600000</span>
        </p>
        <p>The table below provides a list of possible keys you can add to your string and their descriptions:</p>
        <table>
            <thead>
                <tr>
                    <th>Key Name</th>
                    <th>Mandatory</th>
                    <th>Description</th>
                </tr>
            </thead>
            <tbody>
                <tr>
                    <td>AllowLargeResults</td>
                    <td>No</td>
                    <td>The value of this key is 0 or 1.0: Disabled. The driver returns an error when query results are larger than 128MB in size.1: Enabled. The driver allows query results that are larger than 128MB in size.</td>
                </tr>
                <tr>
                    <td>ExecCatalog</td>
                    <td>Yes</td>
                    <td>The name of the project to bill for queries that are run using the DSN.</td>
                </tr>
                <tr>
                    <td>Project or Catalog</td>
                    <td>Yes</td>
                    <td>The name of your BigQuery project.</td>
                </tr>
                <tr>
                    <td>LargeResultDataSetId</td>
                    <td>Yes*</td>
                    <td>
                        <p>The ID of the BigQuery dataset to use to store temporary tables.</p>
                        <p><span class="bold">Note</span>: This option is available only when the Allow Large Result Sets option is enabled (the AllowLargeResults key is set to 1). The dataset created from the default ID is hidden.</p>
                        <p>*Required if AllowLargeResults is enabled.</p>
                    </td>
                </tr>
                <tr>
                    <td>DefaultStringColumnLength</td>
                    <td>No</td>
                    <td>The maximum data length for STRING columns.</td>
                </tr>
                <tr>
                    <td>UseNativeQueryMetadata</td>
                    <td>No</td>
                    <td>
                        <p>The value of this key is 0 or 1.</p>
                        <p><span class="bold">0</span>: Disabled. The driver does not retrieve metadata during the prepare stage.</p>
                        <p><span class="bold">1</span>: Enabled. The driver retrieves metadata during the prepare stage of a query when working in Native Query mode.</p>
                        <p><span class="bold">Note</span>: This option is available only when UseNativeQuery key is set to 1.</p>
                    </td>
                </tr>
                <tr>
                    <td>MaxRequestsPerSecond</td>
                    <td>No</td>
                    <td>The maximum number of requests that can be made per second. To allow an unlimited number of requests per second with no throttling, set the value to 0.</td>
                </tr>
                <tr>
                    <td>ProxyHost</td>
                    <td>No</td>
                    <td>The IP address or hostname of the proxy server. If this key is not set for the Linux or Mac OS X driver, then support for connecting to proxy servers is disabled.</td>
                </tr>
                <tr>
                    <td>ProxyPwd</td>
                    <td>Yes*</td>
                    <td>
                        <p>The password corresponding to the user name provided in the Proxy Username field (the ProxyUid key).</p>
                        <p>*Required if connecting to a proxy server.</p>
                    </td>
                </tr>
                <tr>
                    <td>ProxyPort</td>
                    <td>Yes*</td>
                    <td>
                        <p>The number of the port on which the proxy server is listening.</p>
                        <p>*Required if connecting to a proxy server.</p>
                    </td>
                </tr>
                <tr>
                    <td>ProxyUid</td>
                    <td>Yes*</td>
                    <td>
                        <p>The user name that you use to access the proxy server.</p>
                        <p>*Required if connecting to a proxy server.</p>
                    </td>
                </tr>
                <tr>
                    <td>RefreshToken</td>
                    <td>Yes</td>
                    <td>The refresh token that you obtain from Google for authorizing access to BigQuery. When you configure a DSN with the Windows driver, the refresh token is generated automatically after you provide the confirmation code. When you configure a DSN with the Linux or Mac OS X versions of the driver, you must use the Refresh Token configuration tool to generate the token.</td>
                </tr>
                <tr>
                    <td>RowsFetchedPerBlock</td>
                    <td>No</td>
                    <td>The maximum number of rows that the driver can fetch for each data request.</td>
                </tr>
                <tr>
                    <td>LargeResultsTempTable ExpirationTime</td>
                    <td>Yes*</td>
                    <td>
                        <p>The length of time (in milliseconds) for which a temporary table exists.</p>
                        <p><span class="bold">Note</span>: This option is available only when AllowLargeResults key is set to 1. The default value is 1 hour in milliseconds.*Required if AllowLargeResults is enabled.</p>
                    </td>
                </tr>
                <tr>
                    <td>UseNativeQuery</td>
                    <td>No</td>
                    <td>
                        <p>The value of this key is 0 or 1.</p>
                        <p><span class="bold">0</span>:Disabled. The driver transforms the queries emitted by an application and converts them into an equivalent form in BigQuery SQL.</p>
                        <p><span class="bold">1</span>: Enabled. The driver does not transform the queries emitted by an application, so the native query is used.</p>
                        <p><span class="bold">Note</span>: If an application already emits BigQuery SQL, then enable this option to avoid the extra overhead of query transformation.</p>
                    </td>
                </tr>
            </tbody>
        </table>
        <h2 class="notoc"><a name="Adding2"></a>Adding BigQuery Tables to your Project</h2>
        <p>After setting up the DSN or the DSN-less connection, the Add table from BigQuery Tables window is displayed.</p>
        <p>
            <img src="../../../Resources/Images/addtablesBigQuery (1).png" class="thumblarge" />
        </p>
        <p>From this window, you add your BigQuery tables to your <MadCap:variable name="Variables.ECM" />. In addition, you can view the SQL syntax in the Query Preview section and click Edit to customize it.</p>
        <p class="bold">To add BigQuery Tables to your Project:</p>
        <ol>
            <li>Connect to Google BigQuery via the <MadCap:variable name="Variables.CompanyName" /> ODBC Tool.</li>
            <li>Add your data source.</li>
            <li>In the Add table from BigQuery Tables window, select the table you want to add to the <MadCap:variable name="Variables.ECM" />.</li>
            <li>Click <span class="bold">Add</span>. The selected tables are added to your <MadCap:variable name="Variables.ECM" />.</li>
        </ol>
    </body>
</html>