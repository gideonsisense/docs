<?xml version="1.0" encoding="utf-8"?>
<html xmlns:MadCap="http://www.madcapsoftware.com/Schemas/MadCap.xsd">
    <head><title>SSO via SAML 2.0 | Sisense | Documentation</title>
    </head>
    <body>
        <h1>SSO via SAML 2.0</h1>
        <p>The <MadCap:variable name="Variables.CompanyName" /> SAML authentication process is based on the SAML 2.0 protocol, and is explained in the following diagrams:</p>
        <p>
            <img src="../../../../Resources/Images/phase1-1.png" class="thumblarge" />
        </p>
        <h2 class="notoc">Phase 1</h2>
        <p>The first phase of this process begins when a user requests a resource from <MadCap:variable name="Variables.CompanyName" /> via their browser (1). The browser generates a resource request to the <MadCap:variable name="Variables.CompanyName" /> server. The server processes this request (2), and for unauthenticated users, returns a special save-hash page to save the requested hash data.</p>
        <p>After the browser loads the save-hash page from the <MadCap:variable name="Variables.CompanyName" /> server, it runs a script, which loads the requested resource hash from the URL and sends it to the <MadCap:variable name="Variables.CompanyName" /> Server (3).</p>
        <p>At the end of this phase, the <MadCap:variable name="Variables.CompanyName" /> Server converts the requested resource URL and sends it to the browser as a part of the redirect to IdP Server command (4).</p>
        <h2 class="notoc">Phase 2</h2>
        <p>The second phase of the authentication process starts after the browser retrieves the redirect command from the <MadCap:variable name="Variables.CompanyName" /> Server, and sends the authentication request to the IdP Server (1) as described in the diagram below.</p>
        <p>
            <img src="../../../../Resources/Images/phase2-1.png" class="thumblarge" />
        </p>
        <p>The base URL for this request is taken from the <span class="bold">Remote Login URL</span> field in the Single Sign On section of the <span class="bold">Admin</span> page in the <MadCap:variable name="Variables.Sisense Web Application" />.</p>
        <p>The requested resource address is passed to this request as a RelayState parameter. All other data is provided as a SAMLRequest parameter.</p>
        <p>The next step of this phase depends on the user authentication state and the IdP implementation.</p>
        <p>If the current user isn’t logged in as an IdP user, the IdP server redirects the browser to your Login page (2), where the user enters their IdP credentials. After logging in, the IdP Server sends the browser the Auto-Sign-In page with encoded data about the currently logged-in user (4).</p><span class="bold">Note</span>: Two-factor authentication for <MadCap:variable name="Variables.CompanyName" /> is supported for SSO providers that support two-factor authentication.<p>After this document is loaded in the user’s browser, it runs a script which creates the POST-query to the <MadCap:variable name="Variables.CompanyName" /> Server API, and passes the SAML response to this query (1). At this time, the third phase of the authentication process begins.</p><h2 class="notoc">Phase 3</h2><p>The <MadCap:variable name="Variables.CompanyName" /> Server handles the POST-query (2), decrypts it with the certificate specified in the Public X.509 Certificate field defined in the Single Sign On section of the <span class="bold">Admin</span> page. The <MadCap:variable name="Variables.CompanyName" /> Server uses the decrypted User ID as a key to locate the Sisense user in the internal database.</p><p><img src="../../../../Resources/Images/phase3.png" class="thumblarge" /></p><p>If a user is not found in the system, <MadCap:variable name="Variables.CompanyName" /> creates a new user (3).</p><p>When <MadCap:variable name="Variables.CompanyName" /> creates a new user, <MadCap:variable name="Variables.CompanyName" /> analyzes the “memberOf” field to locate one or more groups related to the logged-in user.</p><p>If the “memberOf” field is empty, the user is assigned the role: “Viewer”. If the “memberOf” field contains one or more groups, and the groups were previously defined in Sisense, the newly created users’ Role is taken from the groups’ default role. When multiple Sisense Groups are found, the user is assigned the role with the maximum privileges.</p><p>After a user is created in the system, an administrator can modify the user role, if needed.</p><p>Below, is an example of an SAML XML where the “Test” group is specified:</p><pre xml:space="preserve">&lt;saml:Attribute
    NameFormat="urn:oasis:names:tc:SAML:2.0:attrname-format:basic
    Name="memberOf"&gt;
    &lt;saml:AttributeValue
        xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
        xsi:type="xs:string"&gt;
        Test
     &lt;/saml:AttributeValue&gt;
&lt;/saml:Attribute&gt;</pre><p>After the user is located or created, a new session is initialized, and the <MadCap:variable name="Variables.CompanyName" /> Server redirects the user browser to the requested resource (4).</p><h2 class="notoc">Enabling SSO via SAML in <MadCap:variable name="Variables.CompanyName" /></h2><p>After you have configured your SAML server, sign in to <MadCap:variable name="Variables.CompanyName" /> as an Administrator and follow the instructions below.</p><p class="bold">To enable SAML in <MadCap:variable name="Variables.CompanyName" />:</p><ol><li>In the <MadCap:variable name="Variables.Sisense Web Application" />, click <span class="bold">Admin</span> and select <span class="bold">Single Sign On</span>.<br /><img src="../../../../Resources/Images/ssosaml.png" class="thumblarge" /></li><li>In the Single Sign On page, select <span class="bold">SAML 2.0</span>.</li><li>In the <span class="bold">Remote Login URL</span> field, enter the SAML Login endpoint. <MadCap:variable name="Variables.CompanyName" /> redirects the user to this field when they sign in. This value should be provided by the IdP Service.</li><li>In the <span class="bold">Remote Logout URL</span> field, enter the SAML Logout endpoint. Sisense redirects the user to this field when they sign out. This value should be provided by the IdP Service.</li><li>In the <span class="bold">Public X.509 Certificate</span> field, enter your public key for your SAML configuration.  This value should be provided by the IdP Service.</li><li>Click <span class="bold">Save</span>. SSO via SAML 2.0 is configured.</li></ol><h2 class="notoc"><MadCap:variable name="Variables.CompanyName" /> Default Role Set-Up</h2><p>When an authenticated user is not found in the <MadCap:variable name="Variables.CompanyName" /> database, a new account is created.  The user role is specified based on the user group/groups default role.</p><p class="bold">To define a group’s role:</p><ol><li>In the <MadCap:variable name="Variables.Sisense Web Application" />, click <span class="bold">Admin</span> and select <span class="bold">Groups</span>.<br /><img src="../../../../Resources/Images/groupsad.png" class="thumblarge" /></li><li>Click <span class="bold">Add Group</span>. The Create a New Group window is displayed.</li><li>In the <span class="bold">Create a New Group</span> window, select the default role of the group.<br /><img src="../../../../Resources/Images/chooserole.png" class="thumblarge" /></li><li>Click <span class="bold">Save</span>.</li></ol><p><span class="bold">Note</span>: Changes to the group’s default role are applied when new users are created, and do not affect existing users. After a user is created in the system, an administrator can modify the user role, if needed.</p><h3 class="notoc">Related Topics</h3><p>For instructions on setting up <MadCap:variable name="Variables.CompanyName" /> with some 3rd-party providers, see:&#160;</p><ul><li><a href="https://support.sisense.com/hc/en-us/articles/360003730073-Setting-Up-SSO-SAML-2-0-with-Okta" target="_blank">Setting Up SSO SAML 2.0 with Okta</a></li><li><a href="https://support.sisense.com/hc/en-us/articles/360003704734-Setting-Up-SSO-SAML-2-0-with-OneLogin" target="_blank">Setting Up SSO SAML 2.0 with OneLogin</a></li><li><a href="https://support.sisense.com/hc/en-us/articles/360003729933-Setting-Up-SSO-SAML-2-0-with-Auth0" target="_blank">Setting Up SSO SAML 2.0 with Auth0</a></li><li><a href="https://support.sisense.com/hc/en-us/articles/115007984047-Setting-Up-SSO-SAML-2-0-with-Salesforce" target="_blank">Setting Up SSO SAML 2.0 With Salesforce</a></li><li><a href="https://support.sisense.com/hc/en-us/articles/360000533993-Setting-Up-SSO-SAML-2-0-With-ADFS" target="_blank">Setting Up SSO SAML 2.0 With ADFS</a></li><li><a href="https://support.sisense.com/hc/en-us/articles/115007980607-Setting-Up-SSO-SAML-2-0-with-G-Suite" target="_blank">Setting Up SSO SAML 2.0 With G Suite</a></li></ul></body>
</html>